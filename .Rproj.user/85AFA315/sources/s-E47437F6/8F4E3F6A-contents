!function(){"use strict";var a={allQuizzes:[],baseURL:"",compatibilityClassNames:{"zuordnungs-quiz":"rquiz-matching","lueckentext-quiz":"rquiz-gapfill","memo-quiz":"rquiz-memo","multiplechoice-quiz":"rquiz-multichoice","schuettel-quiz":"rquiz-wordjumble","kreuzwort-quiz":"rquiz-crossword","suchsel-quiz":"rquiz-wordsearch","buchstabenraten-quiz":"rquiz-wordguess"},functionsAfterCssReady:[],i18n:{de:{allFound:"Alle Sets found!",attemptLastTime:"Das letzte Mal hatten Sie nur einen Versuch benötigt.",attemptsLastTime:"Das letzte Mal hatten Sie %n Versuche benötigt.",check:"prüfen!",endOfQuiz:"Quiz ist zuende.",enter:"eintragen",enterNotice:"Benutzen Sie zur Eingabe die Tastatur. Eventuell müssen sie zuerst ein Eingabefeld durch Anklicken aktivieren.",enterNoticeWordGuessing:"Benutzen Sie die Tastatur zur Eingabe! Eventuell müssen Sie erst in das Quiz klicken, um es zu aktivieren.",foundWords:"Erkannte Wörter",guessedChars:"Bereits geratene Buchstaben",horizontal:"Waagrecht",howAboutNewRound:"Wie wär's mit einer neuen Runde?",input:"Eingabe",percentageResult:"Die Antworten sind zu %n% richtig.",praise1:"Ausgezeichnet!",praise2:"Gut gemacht!",praise3:"Das war nicht schlecht!",remainingTries:"Sie haben noch %n Versuche übrig!",restart:"neu starten",result1:"Die Aufgabe wurde gleich beim ersten Versuch erfolgreich gelöst!",result2:"Die Aufgabe wurde nach nur zwei Versuchen erfolgreich gelöst!",result3:"Die Aufgabe wurde nach %n Versuchen erfolgreich gelöst!",startQuiz:"Quiz starten.",tempText:"Text...",vertical:"Senkrecht"},en:{allFound:"You've found all sets!",attemptLastTime:"Last time you only needed a single attempt.",attemptsLastTime:"Last time you needed %n attempts.",check:"check it!",endOfQuiz:"Quiz is over.",enter:"fill in",enterNotice:"Use the keyboard to enter letters. You may need to first activate a box by clicking it.",enterNoticeWordGuessing:"Use the keyboard to enter letters. You may need to first click somewhere into this quiz in oder to activate it.",foundWords:"Found Words",guessedChars:"Already Guessed Characters",horizontal:"Horizontal",howAboutNewRound:"How about another round?",input:"Input",percentageResult:"The answers are %n% correct.",praise1:"Brilliant!",praise2:"Well done!",praise3:"That was nice!",remainingTries:"You have %n tries left!",restart:"restart",result1:"You solved everything on your first try!",result2:"You solved everything with only two tries!",result3:"You solved everything after trying %n times!",startQuiz:"Start quiz.",tempText:"text...",vertical:"Vertical"},es:{allFound:"¡Encontraste todos los juegos!",attemptLastTime:"Last time you only needed a single attempt.",attemptsLastTime:"Last time you needed %n attempts.",check:"¡Chequear!",endOfQuiz:"Fin de juego",enter:"insertar",enterNotice:"Usa el teclado para entrar letras. Quizás tienes que hacer clic en una caja primero para activárla.",enterNoticeWordGuessing:"Usa el teclado para entrar letras. Quizás tienes que hacer clic en el quiz primero para activárla.",foundWords:"Palabras encontradas",guessedChars:"Letras ya probadas",howAboutNewRound:"¿Otra vez?",horizontal:"Horizontal",input:"Entrada",percentageResult:"Porcentaje de respuestas correctas: %n%.",praise1:"¡Muy bien hecho!",praise2:"¡Bien hecho!",praise3:"¡Correcto!",remainingTries:"¡Usted no tiene que dejan 7 intentos!",restart:"otra vez",result1:"¡Resolviste el ejercicio al primer intento!",result2:"¡Resolviste el ejercicio al segundo intento!",result3:"Intentaste resolver el ejercicio %n veces y ¡lo lograste!",startQuiz:"Empezar quiz.",tempText:"Texto...",vertical:"Vertical"},fr:{allFound:'Tu as trouvé tous les "sets".',attemptLastTime:"Last time you only needed a single attempt.",attemptsLastTime:"Last time you needed %n attempts.",check:"verifier!",endOfQuiz:"Quiz est finis.",enter:"inscrire",enterNotice:"Utilisez le clavier pour inscrire des lettres. Vous devez probablement d'abord activer une boîte en le claquant.",enterNoticeWordGuessing:"Utilisez le clavier pour inscrire des lettres. Vous devez probablement d'abord activer le quiz en le claquant.",foundWords:"Mots trouvés",guessedChars:"Lettres déjà essayées",horizontal:"Horizontal",howAboutNewRound:"Alors tu veux recommencer?",input:"Entrée",percentageResult:"Les réponses sont %n% correctes.",praise1:"Excellent! Super!",praise2:"Bien fait!",praise3:"Ce n'était pas mal",remainingTries:"Vous n'avez pas %n tentatives gauche!",restart:"recommencer",result1:"Ton essai était tout de suite un succès.",result2:"Tu as résoulu le devoir après deux tentatives seulement!",result3:"Tu as résoulu le devoir après %n tentatives.",startQuiz:"Commencer le quiz.",tempText:"Text...",vertical:"Vértical"},la:{allFound:"Omnes partes repperisti.",attemptLastTime:"Last time you only needed a single attempt.",attemptsLastTime:"Last time you needed %n attempts.",check:"probare",endOfQuiz:"Factum est.",enter:"complere",enterNotice:"Utere clavibus ad verba scribenda. Fortasse tibi capsa eligenda est.",enterNoticeWordGuessing:"Utere clavibus ad verba scribenda. Fortasse tibi aenigma eligendum est.",foundWords:"Verba iam reperta",guessedChars:"Litterae iam temptatae",horizontal:"directe",howAboutNewRound:"Ludum novum vis?",input:"implere",percentageResult:"%n% centesimae responsorum rectae sunt.",praise1:"optime!",praise2:"bene!",praise3:"Id non male fecisti.",remainingTries:"Et non sunt derelicti %n conatusque prohibebit!",restart:"novum vis",result1:"Pensum statim in primo conatu feliciter absolutum est!",result2:"Pensum cam post duos conatus feliciter absolutum est.",result3:"Pensum cam post %n conatus feliciter absolutum est.",startQuiz:"Incipere aenigma.",tempText:"scriptum...",vertical:"perpendiculariter"},it:{allFound:"Tutti i sets sono stati risolti!",attemptLastTime:"Last time you only needed a single attempt.",attemptsLastTime:"Last time you needed %n attempts.",check:"controllare!",endOfQuiz:"Il quiz è sopra .",enter:"immettere",enterNotice:"Utilizzi la tastiera per entrare nelle lettere. Potete avere bisogno di in primo luogo di attivare una scatola scattandola.",enterNoticeWordGuessing:"Utilizzi la tastiera per entrare nelle lettere. Potete avere bisogno di in primo luogo di scattarti in qualche luogo in questo quiz per attivarlo.",foundWords:"Parole trovate ",guessedChars:"Lettere già indovinate",howAboutNewRound:"Ancora una volta?",horizontal:"Orizontale",input:"Input",percentageResult:"Le tue risposte sono il %n per cento giuste.",praise1:"Ottimo!",praise2:"Benissimo!",praise3:"Bene!",remainingTries:"Non si dispone di %n tentativi di sinistra!",restart:"ancora una volta",result1:"Il compito è stato risolto al primo passo!",result2:"Il compito è stato risolto dopo la seconda prova!",result3:"Il compito è stato risolto dopo %n prove.",startQuiz:"Inizi il quiz.",tempText:"Testo...",vertical:"Verticale"},pl:{allFound:"Znalazłaś/łeś wszystkie pary!",attemptLastTime:"Last time you only needed a single attempt.",attemptsLastTime:"Last time you needed %n attempts.",check:"Sprawdź!",endOfQuiz:"Koniec quizu.",enter:"Wpisz",enterNotice:"Aby wpisać rozwiązanie użyj klawiatury. Kliknij pole, aby wprowadzić text!",enterNoticeWordGuessing:"Aby wpisać rozwiązanie użyj klawiatury. Kliknij pole, aby wprowadzić text!",foundWords:"Rozpoznane słówka",guessedChars:"Odgadnięte litery",horizontal:"Poziomo",howAboutNewRound:"Co powiesz na drugą rundę? Spróbuj jeszcze raz!",input:"Wprowadzanie",percentageResult:"Odpowiedzi są poprawne w %n procentach.",praise1:"Celująco!",praise2:"Bardzo dobrze!",praise3:"Nieźle!",remainingTries:"Nie masz %n% prób w lewo!",restart:"restart",result1:"Zadanie rozwiązałaś/łeś poprawnie za pierwszym razem!",result2:"Zadanie rozwiązałaś/łeś poprawnie za drugim razem!",result3:"Zadanie zostało rozwiązane poprawnie po %n próbach !",startQuiz:"Start quizu.",tempText:"Tekst...",vertical:"Pionowo"},tr:{allFound:"Tüm setler bulunmus bulunmaktadir!",attemptLastTime:"Son seferde yalnizca bir deneme yapmaniz gerekti.",attemptsLastTime:"Son seferde %n deneme yapmaniz gerekti.",check:"Kontrol ediniz!",endOfQuiz:"Test bitmistir.",enter:"Giriniz",enterNotice:"Giris icin klavyeyi kullaniniz. Belki öncelikle tiklayarak bir giris alani etkinlestirmeniz gerekmektedir.",enterNoticeWordGuessing:"Giris icin klavyeyi kullaniniz! Testi etkinlestirmek icin belki öncelikle testi tiklamalisiniz.",foundWords:"Taninan kelimeler",guessedChars:"Simdiden bulunan harfler",horizontal:"Yatay",howAboutNewRound:"Yeni bir tura ne dersiniz?",input:"Giris",percentageResult:"Cevaplar %n% dogru.",praise1:"Mükemmel!",praise2:"Iyi yaptiniz!",praise3:"Bu fena degildi!",remainingTries:"%n denemeniz kaldi",restart:"Yeniden baslat",result1:"Ödev ilk denemede basari ile cözüldü!",result2:"Ödev yalnizca iki denemeden sonra basari ile cözüldü!",result3:"Ödev %n denemeden sonra basari ile cözüldü!",startQuiz:"Testi baslat.",tempText:"metin...",vertical:"dikey"}},initialized:!1,utf8Replacements:{A:["A","a","À","Á","Â","Ã","Å","à","á","â","ã","å"],AE:["Ä","Æ","ä","æ"],B:["B","b"],C:["C","c","Ç","ç"],D:["D","d"],E:["E","e","È","É","Ê","Ë","è","é","ê","ë"],F:["F","f"],G:["G","g"],H:["H","h"],I:["I","i","Ì","Í","Î","Ï","ì","í","î","ï"],J:["J","j"],K:["K","k"],L:["L","l"],M:["M","m"],N:["N","n","Ñ","ñ"],O:["O","o","Ò","Ó","Ô","Õ","ò","ó","ô","õ"],OE:["Ö","ö"],P:["P","p"],Q:["Q","q"],R:["R","r"],S:["S","s"],SS:["ß"],T:["T","t"],U:["U","u","Ù","Ú","Û","ù","ú","û"],UE:["Ü","ü"],V:["V","v"],W:["W","w"],X:["X","x"],Y:["Y","y","Ý","ý"],Z:["Z","z"]},quizConstructors:{},begin:function(){a.initialized||(a.initialized=!0,a.each(a.quizConstructors,function(b,c){"_abstractQuiz"!=c&&(b.prototype=Object.create(a.quizConstructors._abstractQuiz),b.prototype.constructor=a.quizConstructors[c],b.prototype.type=c)}),a.each(document.querySelectorAll('[class^="rquiz-"], [class$="-quiz"]'),function(b){a.each(a.compatibilityClassNames,function(a,c){b.classList.contains(c)&&(b.classList.remove(c),b.classList.add(a))}),a.each(a.quizConstructors,function(c,d){b.classList.contains("rquiz-"+d)&&"_abstractQuiz"!=d&&new a.quizConstructors[d](b)})}),document.body.classList.add("rquiz"))},create:function(a){var b,c;if(a.tagName&&a.tagName.match(/[a-z]/)){b=document.createElement(a.tagName);for(c in a)c.match(/^text/i)?b.appendChild(document.createTextNode(a[c])):c.match(/^tagname$/i)||(b[c]=a[c])}return b},onCssReady:function(){a.each(a.functionsAfterCssReady,function(a){a()})},each:function(a,b,c){var d,e;if(!a)return 0;if(c=c||a,void 0!==a.length){for(d=0,e=a.length;d<e;d++)if(!1===b.call(c,a[d],d,a))return 0}else for(d in a)if(a.hasOwnProperty(d)&&!1===b.call(c,a[d],d,a))return 0;return 1},init:function(){var c,b=document.querySelector("head");a.each(document.getElementsByTagName("script"),function(b){b.src&&b.src.match(/\/rquiz.js\b/)&&(a.baseURL=b.src.substr(0,b.src.lastIndexOf("/")))}),a.baseURL&&b&&(c=b.appendChild(a.create({href:a.baseURL+"/rquiz.css",rel:"stylesheet",tagName:"link"})),c.addEventListener("load",function(){a.onCssReady()})),document.addEventListener("DOMContentLoaded",function(){a.begin()})},shuffleArray:function(a){for(var c,d,b=a.length;b;)c=Math.random()*b--|0,d=a[b],a[b]=a[c],a[c]=d},trim:function(a){var b="["+String.fromCharCode(32)+String.fromCharCode(160)+"\t\r\n]+";return a.replace(new RegExp("^"+b,"g"),"").replace(new RegExp(b+"$","g"),"")},utf8NormalizeToUpper:function(b){var d,e,f,c="";for(e=0;e<b.length;e++)if(b[e]==String.fromCharCode(160)||b[e]==String.fromCharCode(32))c+=String.fromCharCode(160);else for(d in a.utf8Replacements)if(d.match(/^[A-Z][A-Z]?$/))for(f=0;f<a.utf8Replacements[d].length;f++)b.substr(e,1)==a.utf8Replacements[d][f]&&(c+=d);return c}};a.quizConstructors._abstractQuiz=function(b){var c=this;c.attempts=0,c.container=b,c.data=[],c.draggableClass="rquiz-draggable",c.draggingClass="rquiz-dragging",c.dragElm=null,c.dragging=!1,c.dragMode=!1,c.errorClass="rquiz-error",c.finishedClass="rquiz-finished",c.highlightClass="rquiz-highlighted",c.lang="de",c.lastCoords={left:0,top:0},c.pieces=[],c.piecesClass="rquiz-piece",c.pool=document.createElement("p"),c.poolClass="rquiz-pool",c.printOnlyClass="rquiz-print",c.quizName="rquiz"+a.allQuizzes.length,c.restartButton=document.createElement("button"),c.result=document.createElement("p"),c.resultButton=document.createElement("button"),c.resultClass="rquiz-result",c.screenOnlyClass="rquiz-screen",c.targetClass="rquiz-target",c.targets=[],c.waitClass="rquiz-waiting",c.createWordGrid=function(b,c,d,e){for(var j,k,l,m,n,o,p,q,r,s,t,u,v,w,f=[],g=1,h=c?10:1,i=(d?"→↓↘↗":"→↓").split("");g>0&&f.length<h;){for(g=0,t=[],m=[],s=0,a.each(b,function(a){s+=a.upperCase.length+2}),o=new Array(s),l=0;l<s;l++)o[l]=new Array(s);for(;t.length<b.length;){for(s=!0;s;)r=Math.floor(Math.random()*b.length),s=!1,a.each(t,function(a){a.upperCase==b[r].upperCase&&(s=!0)}),m.length>0&&a.each(m,function(a){b[r]==a&&(s=!0)});if(u=b[r],u.x=-1,u.y=-1,t.length>0){for(j=0;j<t.length&&!(u.x>=0&&u.y>=0);j++)for(p=[],k=0;k<u.upperCase.length&&!(u.x>=0&&u.y>=0);k++){for(s=!0;s;)r=Math.floor(Math.random()*u.upperCase.length),s=p[r];if(p[r]=!0,t[j].upperCase.indexOf(u.upperCase.substr(r,1))>=0)for(n=0;n<t[j].upperCase.length&&!(u.x>=0&&u.y>=0);n++)if(t[j].upperCase.substr(n,1)==u.upperCase.substr(r,1)){for(s=!0,"→"==t[j].orientation&&(v=t[j].x+n,w=t[j].y),"↓"==t[j].orientation&&(v=t[j].x,w=t[j].y+n),"↘"==t[j].orientation&&(v=t[j].x+n,w=t[j].y+n),"↗"==t[j].orientation&&(v=t[j].x+n,w=t[j].y-n),q=[],l=0;l<i.length;l++)i[l]!=t[j].orientation&&q.push(i[l]);for(a.shuffleArray(q);q.length;){for(u.orientation=q.pop(),"↓"==u.orientation&&(w-=r),"→"==u.orientation&&(v-=r),"↘"==u.orientation&&(v-=r,w-=r),"↗"==u.orientation&&(v-=r,w+=r),l=0;l<u.upperCase.length;l++)"→"==u.orientation&&(o[w][v+l]&&o[w][v+l]!=u.upperCase.substr(l,1)&&(s=!1),e||a.each(t,function(a){"→"!=a.orientation||a.y+1!=w&&a.y-1!=w||(a.x<=v&&a.upperCase.x+a.upperCase.length>=v+u.upperCase.length||a.x<=v&&a.x+a.upperCase.length>=v||a.x>v&&a.x<=v+u.upperCase.length)&&(s=!1),"↓"==a.orientation&&a.y-1==w&&a.x>=v&&a.x<=v+u.upperCase.length&&(s=!1)})),"↓"==u.orientation&&(o[w+l][v]&&o[w+l][v]!=u.upperCase.substr(l,1)&&(s=!1),e||a.each(t,function(a){"↓"!=a.orientation||a.x!=v+1&&a.x!=v-1||(a.y<=w&&a.upperCase.y+a.upperCase.length>=w+u.upperCase.length||a.y<=w&&a.y+a.upperCase.length>=w||a.y>w&&a.y<=w+u.upperCase.length)&&(s=!1),"→"!=a.orientation||a.x!=v+1&&a.x!=v-u.upperCase.length-1||a.y>=w&&a.y<=w+u.upperCase.length&&(s=!1)})),"↘"==u.orientation&&o[w+l][v+l]&&o[w+l][v+l]!=u.upperCase.substr(l,1)&&(s=!1),"↗"==u.orientation&&o[w-l][v+l]&&o[w-l][v+l]!=u.upperCase.substr(l,1)&&(s=!1);if("→"==u.orientation&&(o[w][v-1]||o[w][v+u.upperCase.length])&&(s=!1),"↓"==u.orientation&&(o[w-1][v]||o[w+u.upperCase.length][v])&&(s=!1),"↘"==u.orientation&&(o[w-1][v-1]||o[w+u.upperCase.length][v+u.upperCase.length])&&(s=!1),"↗"==u.orientation&&(o[w+1][v-1]||o[w-u.upperCase.length][v+u.upperCase.length])&&(s=!1),s){u.x=v,u.y=w,m=[];break}}if(s)break}}u.x<0&&u.y<0&&(m.push(u),m.length==b.length-t.length&&(g++,r=Math.floor(4*Math.random()),!0&r?(w=Math.floor(o.length/2)-Math.floor(u.upperCase.length/2),v=2==(2&r)?0:o[0].length):(v=Math.floor(o[0].length/2),w=2==(2&r)?0:o.length),u.orientation=0==(1&r)?"→":"↓",a.each(t,function(a){1==(1&r)?(0==(2&r)&&a.x<v&&(v=a.x),2==(2&r)&&(s=a.x,"→"==a.orientation&&(s+=a.upperCase.length),s>v&&(v=s))):(0==(2&r)&&a.y<w&&(w=a.y),2==(2&r)&&(s=a.y,"↓"==a.orientation&&(s+=a.upperCase.length),s>w&&(w=s)))}),u.x=0==(2&r)?v-2:v+2,u.y=0==(2&r)?w-2:w+2,m=[]))}else u.x=Math.floor(o[0].length/2),u.y=Math.floor(o.length/2)-Math.floor(u.upperCase.length/2),u.orientation="↓";if(u&&u.x>=0&&u.y>=0)for(t.push(u),l=0;l<u.upperCase.length;l++)"→"==u.orientation&&(o[u.y][u.x+l]=u.upperCase.substr(l,1)),"↓"==u.orientation&&(o[u.y+l][u.x]=u.upperCase.substr(l,1)),"↘"==u.orientation&&(o[u.y+l][u.x+l]=u.upperCase.substr(l,1)),"↗"==u.orientation&&(o[u.y-l][u.x+l]=u.upperCase.substr(l,1))}f.push({grid:o,data:t,taints:g})}for(g>0&&(s=!1,a.each(f,function(a){(!s||a.taints<s.taints)&&(s=a)}),o=s.grid,t=s.data),j={x:{min:o[0].length,max:0},y:{min:o.length,max:0}},w=0;w<o.length;w++)for(v=0;v<o[0].length;v++)o[w][v]&&(j.x.min=j.x.min>v?v:j.x.min,j.y.min=j.y.min>w?w:j.y.min,j.x.max=j.x.max<v?v:j.x.max,j.y.max=j.y.max<w?w:j.y.max);for(s=new Array(j.y.max-j.y.min+1),w=0;w<j.y.max-j.y.min+1;w++)for(s[w]=new Array(j.x.max-j.x.min+1),v=0;v<j.x.max-j.x.min+1;v++)o[w+j.y.min][v+j.x.min]&&(s[w][v]=o[w+j.y.min][v+j.x.min]);for(o=s,l=0;l<t.length;l++)t[l].x=t[l].x-j.x.min,t[l].y=t[l].y-j.y.min;return{grid:o,words:t}},c.dragStart=function(b){var d=c.getEventElement(b);for(b.touches&&b.touches[0]&&(c.lastCoords.left=b.touches[0].clientX,c.lastCoords.top=b.touches[0].clientY);!(d==document.body||d.className&&d.classList.contains(c.draggableClass));)d=d.parentNode;return d!=document.body&&d.classList.contains(c.draggableClass)&&(c.dragMode=!0,a.each(document.querySelectorAll("input"),function(a){try{a.blur()}catch(a){}}),c.dragElm=d,c.dragElm.classList.add(c.draggingClass),b.preventDefault()),!c.dragMode},c.dragStop=function(a){return!(!c.dragElm||!c.dragElm.className)&&(c.repairDragAndDropOnIE(),c.dragging&&(c.dragElm.style.top="",c.dragElm.style.left="",c.dragElm.classList.remove(c.draggingClass)),c.dragElm.classList.remove(c.draggingClass),c.dragging&&c.resolveDragDrop&&c.resolveDragDrop(),c.dragElm=null,c.dragging=!1,c.dragMode=!1,c.highlightElm&&(c.highlightElm.classList.remove(c.highlightClass),c.highlightElm=null),!1)},c.dragWhile=function(a){var e,f,b=a.clientX,d=a.clientY;return a.touches&&(b=a.touches[0].clientX,d=a.touches[0].clientY),e=c.lastCoords.left-b,f=c.lastCoords.top-d,c.lastCoords.left=b,c.lastCoords.top=d,!c.dragElm||!c.dragMode||(c.dragging=!0,a.preventDefault(),b=0,d=0,c.dragElm.style.left&&(b=parseFloat(c.dragElm.style.left),d=parseFloat(c.dragElm.style.top)),c.dragElm.style.left=b-e+"px",c.dragElm.style.top=d-f+"px",c.highlightTarget(),!0)},c.finalize=function(b){var d=function(b){a.each(b.getElementsByTagName("a"),function(a){a.addEventListener("click",function(a){return!!c.container.classList.contains(c.finishedClass)||(a.preventDefault(),a.stopPropagation(),!1)})})};c.resultButton.innerHTML=a.i18n[c.lang].check,c.restartButton.innerHTML=a.i18n[c.lang].restart,c.restartButton.addEventListener("click",function(){c.start()}),c.resultButton.addEventListener("click",function(){c.end()}),d(c.container),a.each(c.pieces,d),a.allQuizzes.push(c),a.each(c.pieces,function(a){a.setAttribute("data-quiz",c.quizName)}),c.pool.parentNode.insertBefore(c.result,c.pool.nextSibling),c.result.appendChild(c.restartButton),c.container.id=c.quizName,c.container.addEventListener("mousemove",c.dragWhile),c.container.addEventListener("touchmove",c.dragWhile),c.pool.classList.add(c.poolClass),c.result.classList.add(c.resultClass),b||c.start()},c.getEventElement=function(a){return a=a||window.event,a.touches?document.elementFromPoint(a.touches[0].clientX,a.touches[0].clientY):a.target||a.srcElement},c.hideResultButton=function(a){a?c.pool.appendChild(c.resultButton):c.resultButton.parentNode&&c.resultButton.parentNode.removeChild(c.resultButton)},c.highlightTarget=function(){var b;c.highlightElm=null,b=c.targets,b.push(c.pool),a.each(b,function(a){var b=a.getBoundingClientRect();a.classList.remove(c.highlightClass),b.top<c.lastCoords.top&&b.left<c.lastCoords.left&&b.bottom>c.lastCoords.top&&b.right>c.lastCoords.left&&(a.classList.add(c.highlightClass),c.highlightElm=a)})},c.keyUp=function(b){var g,d=c.getEventElement(b),e=d.parentNode.getElementsByTagName("label"),f=e.length;switch(a.each(e,function(a,b){a.classList.contains(c.focusClass)&&(f=b)}),b.keyCode){case 27:c.check();break;case 35:e[f].classList.remove(c.focusClass),e[e.length-1].classList.add(c.focusClass);break;case 36:e[f].classList.remove(c.focusClass),e[0].classList.add(c.focusClass);break;case 37:case 8:f<e.length&&e[f].classList.remove(c.focusClass),f=f>0?f-1:0,d.value="",8==b.keyCode&&(e[f].innerHTML=String.fromCharCode(160)),e[f].classList.add(c.focusClass);break;case 39:e[f].classList.remove(c.focusClass),f=f===e.length-1?f:f+1,e[f].classList.add(c.focusClass)}return d.value.length>0&&(g=a.utf8NormalizeToUpper(d.value.substr(0,1)),setTimeout(function(){d.value=""},10),a.each(g,function(a){e[f].innerHTML=a,e[f].classList.remove(c.focusClass),f<e.length-1&&(f++,e[f].classList.add(c.focusClass))})),!1},c.prepareResult=function(){var b="";for(arguments.length?b=arguments[0]:(b=(c.attempts>2?a.i18n[c.lang].praise3:a.i18n[c.lang]["praise"+c.attempts])+" ",b+=(c.attempts>2?a.i18n[c.lang].result3:a.i18n[c.lang]["result"+c.attempts]).replace("%n",c.attempts)),b+=" ";c.result.firstChild;)c.result.removeChild(c.result.firstChild);c.result.appendChild(document.createTextNode(b)),c.result.appendChild(c.restartButton)},c.removeDragDropListeners=function(){c.container.removeEventListener("mousedown",c.dragStart),c.container.removeEventListener("mouseup",c.dragStop),c.container.removeEventListener("touchstart",c.dragStart),c.container.removeEventListener("touchend",c.dragStop),c.container.removeEventListener("touchcancel",c.dragStop)},c.repairDragAndDropOnIE=function(a){var b=function(){return!1};a?(document.addEventListener("selectstart",b),document.addEventListener("dragstart",b)):(document.removeEventListener("selectstart",b),document.removeEventListener("dragstart",b))},c.setDragDropListeners=function(){c.container.addEventListener("mousedown",c.dragStart),c.container.addEventListener("mouseup",c.dragStop),c.container.addEventListener("touchstart",c.dragStart),c.container.addEventListener("touchend",c.dragStop),c.container.addEventListener("touchcancel",c.dragStop)},c.uploadData=function(){"function"==typeof window.rQuizUploader&&(window.rQuizUploader({quizType:c.type,attempts:c.attempts,end:function(b){var d="";b.length>0&&(d=(a.i18n[c.lang].attemptsLastTime+" ").replace(/%n/,b)),c.restartButton.parentNode.insertBefore(document.createTextNode(d),c.restartButton),c.result.classList.remove(c.waitClass)}}),c.result.classList.add(c.waitClass))},b.hasAttribute("lang")&&a.i18n[b.getAttribute("lang")]&&(c.lang=b.getAttribute("lang"))},a.quizConstructors.crossword=function(b){var c=this;a.quizConstructors._abstractQuiz.call(c,b),c.dialog=document.createElement("dialog"),c.focusClass="rquiz-focus",c.forms={h:document.createElement("form"),v:document.createElement("form")},c.grid=[],c.hiddenClass="rquiz-hidden",c.inputs={h:document.createElement("input"),v:document.createElement("input")},c.printSheet=document.createElement("table"),c.showClass="rquiz-show",c.tagClass="rquiz-tag",c.words=[],c.check=function(){var d,e,f,b=!0;for(f=0;f<c.grid.length;f++)for(e=0;e<c.grid[f].length;e++)d=c.table.rows[f].cells[e],d.hasAttribute("data-c")&&a.trim(d.textContent).length<1&&(b=!1);return c.hideResultButton(b),location.href.match(/\#rquiz\d+_dialog/)&&history.back(),!1},c.click=function(b){var d=c.getEventElement(b),e=document.querySelector("#%s dialog > div > p".replace(/%s/g,c.quizName)),f=document.querySelectorAll("#%s dialog, #%s dialog > div > span".replace(/%s/g,c.quizName)),g={tag:0,words:[]},h=c.dialog.getElementsByTagName("div")[0],i=c.dialog.getElementsByTagName("label");return!c.container.classList.contains(c.finishedClass)&&(d==e&&e.classList.toggle(c.showClass),d.tagName.match(/^label$/i)&&a.each(i,function(a){d==a?a.classList.add(c.focusClass):a.classList.remove(c.focusClass)}),a.each(f,function(a){d==a&&c.check()}),d.hasAttribute("data-tag")&&(g.tag=d.getAttribute("data-tag"),a.each(c.words,function(a){c.table.rows[a.y]&&c.table.rows[a.y].cells[a.x]&&d==c.table.rows[a.y].cells[a.x]&&g.words.push(a)})),g.words.length&&g.tag>0&&(a.each(c.forms,function(a){a.parentNode&&a.parentNode.removeChild(a)}),a.each(g.words,function(b){var f,i,j,k,d="→"==b.orientation?c.forms.h:c.forms.v,e=c.quizName+("→"==b.orientation?"_ih":"_iv");for(h.appendChild(d);d.firstChild;)d.removeChild(d.firstChild);for(i=d.appendChild(document.createElement("p")),i.appendChild(a.create({tagName:"span",text:g.tag,className:c.tagClass})),i.appendChild(document.createTextNode(b.orientation+" "+b.hint)),i=d.appendChild(document.createElement("p")),i.appendChild("→"==b.orientation?c.inputs.h:c.inputs.v),f=0;f<b.upperCase.length;f++)j=b.x,k=b.y,"→"==b.orientation?j+=f:k+=f,i.appendChild(a.create({tagName:"label",htmlFor:e,text:a.trim(c.table.rows[k].cells[j].textContent)})),i.lastChild.setAttribute("data-x",j),i.lastChild.setAttribute("data-y",k);i.appendChild(a.create({tagName:"button",text:"↲"}))}),document.location.href=document.location.href.replace(/\#.*/,"")+"#"+c.quizName+"_dialog",setTimeout(function(){var a=h.offsetHeight;h.style.marginTop=a<c.table.offsetHeight?(c.table.offsetHeight-a)/2+"px":"0px"},100),c.updateForm(c.dialog.getElementsByTagName("form")[0])),!1)},c.end=function(){var d,b=!0;c.attempts++,a.each(c.grid,function(e,f){a.each(e,function(e,g){d=c.table.rows[f].cells[g],e&&a.trim(d.textContent)!=e&&(b=!1)})}),b&&(c.prepareResult(),c.container.classList.add(c.finishedClass),c.uploadData())},c.formSubmit=function(b){var d=c.getEventElement(b),e=d.getElementsByTagName("label"),f=c.dialog.getElementsByTagName("form");return a.each(e,function(a){var b=a.getAttribute("data-x"),d=a.getAttribute("data-y");c.table.rows[d].cells[b].innerHTML=a.innerHTML}),d.parentNode.removeChild(d),f.length?c.updateForm(f[0]):c.check(),b.preventDefault(),b.stopPropagation(),!1},c.hideResultButton=function(a){a?c.resultButton.classList.remove(c.hiddenClass):c.resultButton.classList.add(c.hiddenClass)},c.start=function(){var f,g,h,i,j,b=1,d=c.createWordGrid(c.data,!0),e=c.printSheet.getElementsByTagName("tbody")[0];for(c.grid=d.grid,c.words=d.words;c.table.firstChild;)c.table.removeChild(c.table.firstChild);for(g=0;g<c.grid.length;g++)for(h=c.table.insertRow(c.table.rows.length<=0?0:c.table.rows.length),f=0;f<c.grid[0].length;f++)i=h.appendChild(document.createElement("td")),c.grid[g]&&c.grid[g][f]&&c.grid[g][f].length>0&&i.setAttribute("data-c",c.grid[g][f]),i.innerHTML="aa".replace(/a/g,String.fromCharCode(160));a.each(c.words,function(a){f=a.x,g=a.y,c.table.rows[g]&&c.table.rows[g].cells[f]&&(i=c.table.rows[g].cells[f],i.hasAttribute("data-tag")||i.setAttribute("data-tag",b++))}),c.container.classList.remove(c.finishedClass),c.check(),a.each(e.getElementsByTagName("td"),function(a){a.parentNode.removeChild(a)}),a.each({horizontal:"→",vertical:"↓"},function(b,d){var e=document.createElement("dl"),f=[],g=c.printSheet.getElementsByTagName("tr"),h=document.createElement("td");g[g.length-1].appendChild(h),h.appendChild(e),a.each(c.words,function(a){if(a.orientation==b)try{f.push({tag:c.table.rows[a.y].cells[a.x].getAttribute("data-tag"),hint:a.hint})}catch(a){j=!0}}),f.sort(function(a,b){return a.tag-b.tag}),a.each(f,function(b){e.appendChild(a.create({tagName:"dt",text:b.tag})),e.appendChild(a.create({tagName:"dd",text:b.hint}))})}),j?c.start():(setTimeout(function(){c.dialog.style.left=c.table.offsetLeft-1+"px",c.dialog.style.top=c.table.offsetTop-1+"px",c.dialog.style.height=c.table.offsetHeight+2+"px",c.dialog.style.width=c.table.parentNode.offsetWidth+"px"},1e3),c.pool.appendChild(c.resultButton))},c.updateForm=function(b){var d=b.getElementsByTagName("label");a.each(d,function(b){var d=b.getAttribute("data-x"),e=b.getAttribute("data-y");b.innerHTML=a.trim(c.table.rows[e].cells[d].textContent)}),setTimeout(function(){d[0].classList.add(c.focusClass),b.getElementsByTagName("input")[0].focus()},300)},function(){var f,b=function(){try{document.styleSheets[0].insertRule("#"+c.quizName+"_dialog:target { display: block; }",document.styleSheets[0].cssRules.length)}catch(b){document.querySelector("head").appendChild(a.create({tagName:"style",text:"#"+c.quizName+"_dialog:target { display: block; }"}))}};if(f=c.container.getElementsByTagName("table"),!f[0])return!1;if(a.each(f[0].getElementsByTagName("tr"),function(b){var d=[];a.each(b.getElementsByTagName("td"),function(b){var c=a.trim(b.innerHTML.replace(/&nbsp;/," "));c.length&&d.push(c)}),d.length>1&&c.data.push({hint:d[1],upperCase:a.utf8NormalizeToUpper(d[0])})}),c.data.length){c.table=f[0],f[0].parentNode.insertBefore(c.pool,f[0].nextSibling),f[0].parentNode.insertBefore(c.dialog,f[0].nextSibling),c.dialog.appendChild(document.createElement("div")),c.dialog.id=c.quizName+"_dialog",a.each(c.inputs,function(b,d){b.id=c.quizName+"_i"+d,b.setAttribute("autocomplete","off"),b.addEventListener("blur",function(d){a.each(b.form.getElementsByTagName("label"),function(a){a.classList.remove(c.focusClass)})})});try{b()}catch(c){a.functionsAfterCssReady.push(b)}c.dialog.firstChild.appendChild(a.create({tagName:"span",text:"×"})),c.dialog.firstChild.appendChild(a.create({tagName:"h2",text:a.i18n[c.lang].input})),c.dialog.firstChild.appendChild(a.create({tagName:"p",text:a.i18n[c.lang].enterNotice})),a.each(c.forms,function(a){a.addEventListener("submit",c.formSubmit)}),c.container.addEventListener("click",c.click),a.each(c.inputs,function(a){a.addEventListener("keyup",c.keyUp)}),c.printSheet.appendChild(document.createElement("tbody")),c.printSheet.className=c.printOnlyClass,c.printSheet.lastChild.appendChild(document.createElement("tr")),a.each({horizontal:"→",vertical:"↓"},function(b,d){c.printSheet.lastChild.lastChild.appendChild(a.create({tagName:"th",text:a.i18n[c.lang][d]+" "+b}))}),c.printSheet.lastChild.appendChild(document.createElement("tr")),c.container.appendChild(c.printSheet),c.finalize()}}()},a.quizConstructors.gapfill=function(b){var c=this;a.quizConstructors._abstractQuiz.call(c,b),c.inputs=[],c.end=function(){var b=[],d=!1;c.attempts++,a.each(c.pieces,function(a){var c=a.getAttribute("data-match");a.parentNode.getAttribute("data-match")!=c&&(b.push(a),d=!0)}),a.each(c.inputs,function(b){var e=!1,f=a.trim(b.element.value);a.each(b.solutions,function(a){f==a&&(e=!0)}),e||(b.element.classList.add(c.errorClass),d=!0)}),b.length&&(a.shuffleArray(b),a.each(b,function(a){c.pool.appendChild(a)}),c.hideResultButton()),d?c.hideResultButton():(c.prepareResult(),a.each(c.pieces,function(a){a.classList.remove(c.draggableClass)}),a.each(c.inputs,function(a){console.dir(a),a.element.setAttribute("readonly","")}),c.removeDragDropListeners(c.container),c.container.classList.add(c.finishedClass),c.uploadData())},c.resolveDragDrop=function(){var d,b=!0;if(c.highlightElm){for(;c.highlightElm.firstChild&&c.highlightElm!=c.pool;)c.pool.appendChild(c.highlightElm.firstChild);c.highlightElm.appendChild(c.dragElm)}c.resultButton.parentNode==c.pool&&c.pool.removeChild(c.resultButton),d=c.pool.getElementsByClassName(c.draggableClass),a.each(c.inputs,function(a){a.element.value||(b=!1)}),!d.length&&b&&c.pool.appendChild(c.resultButton)},c.start=function(){for(a.shuffleArray(c.pieces),a.each(c.pieces,function(a){c.pool.appendChild(a),a.classList.add(c.draggableClass)}),a.each(c.inputs,function(a){a.element.value="",a.element.removeAttribute("readonly")}),c.setDragDropListeners(),c.container.classList.remove(c.finishedClass),c.resultButton.parentNode&&c.pool.removeChild(c.resultButton);c.result.firstChild!=c.restartButton;)c.result.removeChild(c.result.firstChild);c.attempts=0},function(){var b=0,d=[];a.each(document.querySelectorAll(".rquiz-gapfill b, .rquiz-gapfill em, .rquiz-gapfill i, .rquiz-gapfill strong"),function(a){for(var b=a;b!=document.body&&b!=c.container;)b=b.parentNode;b==c.container&&d.push(a)}),d.length&&(a.each(d,function(d){var f,g,h,e=a.trim(d.innerHTML),i=[];if(e.match(/\(/))f=e.replace(/[\t\r\n]/g," ").replace(/^([^(]+).*$/,"$1").replace(/(&nbsp; | &nbsp;)/," ").replace(/ +/," ").split("|"),a.each(f,function(b){b=a.trim(b),b.length&&i.push(b)}),i.length&&(g=a.create({tagName:"label",htmlFor:c.quizName+"_"+b,innerHTML:" "+e.replace(/^[^(]*(\(.*) *$/,"$1").replace(/ ?\(\)$/,"")}),f=a.create({tagName:"input",id:c.quizName+"_"+b}),f.setAttribute("placeholder",a.i18n[c.lang].tempText),f.addEventListener("keyup",function(){f.classList.remove(c.errorClass),c.resolveDragDrop()}),g.insertBefore(f,g.firstChild),d.parentNode.replaceChild(g,d),c.inputs.push({element:f,solutions:i}),c.data.push({element:f,solutions:i,type:"input"}),b++);else if(e=a.trim(d.innerHTML),e.length){for(f=a.create({tagName:"span",className:c.piecesClass}),f.innerHTML=e,f.setAttribute("data-match",b),g=a.create({tagName:"span",className:c.targetClass}),g.setAttribute("data-match",b),b++,a.each(c.pieces,function(a){var c="";a.innerHTML==e&&(c=a.getAttribute("data-match")),c.length&&(g.setAttribute("data-match",c),f.setAttribute("data-match",c),b--)}),c.pieces.push(f),c.targets.push(g),h=d;h!=document.body&&h!=c.container;)h=h.parentNode,h.classList.contains("puzzle")&&f.classList.add("puzzle");d.parentNode.replaceChild(g,d),c.data.push({o:{piece:f,target:g},type:"drag&drop"})}}),c.data.length&&(c.container.appendChild(c.pool),c.finalize()))}()},a.quizConstructors.matching=function(b){var c=this;a.quizConstructors._abstractQuiz.call(c,b),c.mode="pairs",c.end=function(){var b=[];c.attempts++,a.each(c.targets,function(d){var e,f;d!=c.pool&&(f=d.getElementsByClassName(c.piecesClass),e=f.item(0).getAttribute("data-group"),a.each(f,function(a){e!==a.getAttribute("data-group")&&b.push(a)}))}),b.length?(a.shuffleArray(b),a.each(b,function(a){c.pool.appendChild(a)}),c.hideResultButton()):(c.prepareResult(),a.each(c.pieces,function(a){a.classList.remove(c.draggableClass)}),c.removeDragDropListeners(c.container),c.container.classList.add(c.finishedClass),c.uploadData())},c.resolveDragDrop=function(){var a;if(c.highlightElm.appendChild(c.dragElm),"pairs"==c.mode)for(a=c.highlightElm.getElementsByClassName(c.draggableClass);a.length>1;)c.pool.appendChild(a[0]);c.hideResultButton(c.pool.getElementsByClassName(c.draggableClass).length<1)},c.start=function(){var e,b=[],d=[];for(a.each(c.targets,function(a){a!=c.pool&&b.push(a)}),a.shuffleArray(b),a.each(c.data,function(f,g){e="pairs"==c.mode?e=Math.floor(2*Math.random()):0,a.each(c.pieces,function(a){g==a.getAttribute("data-group")&&(e==a.getAttribute("data-no")?b[g].appendChild(a):(d.push(a),a.classList.add(c.draggableClass)))}),a.shuffleArray(d),a.each(d,function(a){c.pool.appendChild(a)})}),c.setDragDropListeners(),c.container.classList.remove(c.finishedClass),c.hideResultButton();c.result.firstChild!=c.restartButton;)c.result.removeChild(c.result.firstChild);c.attempts=0},function(){var b,d,e,f;if(e=c.container.getElementsByTagName("table"),e[0]&&(a.each(e[0].getElementsByTagName("tr"),function(b){var d=[];a.each(b.getElementsByTagName("td"),function(b){var c=a.trim(b.innerHTML.replace(/&nbsp;/," "));c.length&&d.push(c)}),d.length>1&&c.data.push(d),d.length>2&&(c.mode="categories")}),c.data.length)){for(e[0].parentNode.insertBefore(c.pool,e[0]),e[0].parentNode.removeChild(e[0]),b=0;b<c.data.length;b++)for(d=0;d<c.data[b].length;d++)f=a.create({tagName:"span",className:c.piecesClass,innerHTML:c.data[b][d]}),f.setAttribute("data-group",b),f.setAttribute("data-no",d),c.pieces.push(f);a.each(c.data,function(){c.targets.push(c.pool.parentNode.insertBefore(a.create({tagName:"p",className:c.targetClass}),c.pool))}),c.finalize()}}()},a.quizConstructors.memo=function(b){var c=this;a.quizConstructors._abstractQuiz.call(c,b),c.cardClass="rquiz-memocard",c.cards=[],c.fixedClass="rquiz-fixed",c.openClass="rquiz-open",c.setLength=2,c.wait=!1,c.click=function(b){var f,d=!0,e=[];if(!c.wait){for(f=c.getEventElement(b);f!=document.body&&!f.classList.contains(c.cardClass);)f=f.parentNode;if(f.classList.contains(c.cardClass)&&!f.classList.contains(c.fixedClass)&&!f.classList.contains(c.openClass)){if(f.classList.add(c.openClass),a.each(c.cards,function(a){a.classList.contains(c.openClass)&&e.push(a)}),e.length<c.setLength)return!1;a.each(e,function(a,b){e[0].getAttribute("data-group")!=e[b].getAttribute("data-group")&&(d=!1)}),d?(a.each(e,function(a){a.classList.remove(c.openClass),a.classList.add(c.fixedClass)}),a.each(c.cards,function(a){a.classList.contains(c.fixedClass)||(d=!1)}),d&&setTimeout(function(){c.container.classList.add(c.finishedClass),c.uploadData(),a.each(c.cards,function(a){a.classList.remove(c.fixedClass)}),c.prepareResult()},1100)):(c.attempts++,c.wait=!0,setTimeout(function(){a.each(e,function(a){a.classList.remove(c.openClass)}),c.wait=!1},2e3))}}return!1},c.start=function(){for(;c.pool.firstChild;)c.pool.removeChild(c.pool.firstChild);a.shuffleArray(c.cards),a.each(c.cards,function(a){c.pool.appendChild(a)}),c.container.classList.remove(c.finishedClass),c.attempts=0},function(){var d,e,f,g,b=1e3;if(g=c.container.getElementsByTagName("table"),g[0]&&(a.each(g[0].getElementsByTagName("tr"),function(d){var e=[];a.each(d.getElementsByTagName("td"),function(b){var c=a.trim(b.innerHTML.replace(/&nbsp;/," "));c.length&&e.push(c)}),e.length>1&&(e.length<b&&(b=e.length),c.data.push(e))}),c.data.length)){for(c.setLength=b,g[0].parentNode.insertBefore(c.pool,g[0]),g[0].parentNode.removeChild(g[0]),c.pool.classList.remove(c.poolClass),d=0;d<c.data.length;d++)for(e=0;e<b;e++)f=a.create({tagName:"span",className:c.cardClass}),f.setAttribute("data-group",d),c.cards.push(f),f.appendChild(document.createElement("span")),f.firstChild.appendChild(document.createElement("span")),f.firstChild.appendChild(document.createElement("span")),f.firstChild.lastChild.appendChild(a.create({tagName:"span",innerHTML:c.data[d][e]}));c.container.appendChild(c.result),c.container.addEventListener("click",c.click),c.finalize()}}()},a.quizConstructors.multichoice=function(b){var c=this;a.quizConstructors._abstractQuiz.call(c,b),c.end=function(){var b=0,d=0,e=a.i18n[c.lang].percentageResult;a.each(c.data,function(c){a.each(c.ol.getElementsByTagName("input"),function(a){var c=!a.parentNode.hasAttribute("data-x");b++,(a.checked&&c||!a.checked&&!c)&&d++,a.disabled=!0})}),c.prepareResult(e.replace("%n",Math.floor(1e4*d/b)/100)+" "),c.container.classList.add(c.finishedClass),c.uploadData()},c.start=function(){c.container.classList.remove(c.finishedClass),a.each(c.data,function(b){for(a.each(b.ol.getElementsByTagName("input"),function(a){a.checked=!1,a.disabled=!1}),b.p.parentNode&&b.p.parentNode.removeChild(b.p);b.ol.firstChild;)b.ol.removeChild(b.ol.firstChild);b.ol.parentNode&&b.ol.parentNode.removeChild(b.ol)}),a.shuffleArray(c.data),a.each(c.data,function(b){c.container.insertBefore(b.p,c.pool),c.container.insertBefore(b.ol,c.pool),a.shuffleArray(b.answers),a.each(b.answers,function(a){b.ol.appendChild(a)})})},function(){var b=0;a.each(document.querySelectorAll(".rquiz-multichoice p"),function(d){for(var g,h,e=d,f=a.trim(d.innerHTML.replace(/[\t\r\n]/g," "));e!=document.body&&e!=c.container;)e=e.parentNode;e==c.container&&(h={answers:[],ol:document.createElement("ol"),p:a.create({tagName:"p",text:a.trim(f.replace(/\(.*/,""))})},g=!1,f.replace(/\(([^)]+)\)/g,function(b,c){var d=a.create({tagName:"input",type:"checkbox"}),e=a.create({tagName:"label",text:" "+c.replace(/^!/,"")}),f=document.createElement("li"),i=!c.match(/^!/);f.appendChild(d),f.appendChild(e),i?g=!0:f.setAttribute("data-x",""),h.answers.push(f)}),h.answers.length>1&&g&&(a.each(h.answers,function(a){var d=c.quizName+"i"+b++;a.getElementsByTagName("input")[0].id=d,a.getElementsByTagName("label")[0].htmlFor=d}),c.data.push(h),d.parentNode.removeChild(d)))}),c.data.length&&(c.container.appendChild(c.pool),c.hideResultButton(!0),c.finalize())}()},a.quizConstructors.wordguess=function(b){var c=this;a.quizConstructors._abstractQuiz.call(this,b),c.counter=document.createElement("p"),c.counterClass="rquiz-counter",c.current=0,c.guessedChars=document.createElement("ul"),c.guessedCharsIncorrect=document.createElement("ul"),c.guessedWords=document.createElement("ol"),c.input=document.createElement("input"),c.remaining=10,c.showClass="rquiz-show",c.click=function(a){var b=c.getEventElement(a),d=c.pool.getElementsByTagName("p")[0];return c.input.focus(),b==d?d.classList.toggle(c.showClass):d.classList.remove(c.showClass),!1},c.end=function(){if(c.remaining>0&&c.current<c.data.length)return c.next();c.prepareResult(""),c.container.classList.add(c.finishedClass),c.uploadData(),setTimeout(function(){c.restartButton.focus()},100)},c.keyUp=function(b){var h,d=c.getEventElement(b),e=a.utf8NormalizeToUpper(a.trim(d.value)).substr(0,1),f=c.guessedChars.getElementsByTagName("li"),g=c.guessedCharsIncorrect.getElementsByTagName("li");return!(e.length<1)&&(a.each(f,function(a){a.getAttribute("data-c")==e&&(a.innerHTML=e,h=!0)}),h||a.each(g,function(a){a.textContent==e&&(h=!0)}),h||(c.guessedCharsIncorrect.appendChild(a.create({tagName:"li",text:e})),c.remaining--,c.updateCounter()),c.remaining<1&&c.end(),setTimeout(function(){d.value=""},10),h=!0,a.each(f,function(a){a.textContent!=a.getAttribute("data-c")&&(h=!1)}),h&&(a.each(c.guessedWords.getElementsByTagName("li"),function(a){""==a.textContent&&h&&(a.innerHTML=c.data[c.current].original,h=!1)}),c.remaining<10&&(c.remaining++,c.updateCounter()),c.end()),!1)},c.next=function(){if(++c.current==c.data.length)return c.end();a.each([c.guessedChars,c.guessedCharsIncorrect],function(a){for(;a.firstChild;)a.removeChild(a.firstChild)}),a.each(c.data[c.current].upperCase.split(""),function(b){c.guessedChars.appendChild(document.createElement("li")),c.guessedChars.lastChild.setAttribute("data-c",a.utf8NormalizeToUpper(a.trim(b)))})},c.start=function(){for(;c.guessedWords.firstChild;)c.guessedWords.removeChild(c.guessedWords.firstChild);a.each(c.data,function(a){c.guessedWords.appendChild(document.createElement("li"))}),a.shuffleArray(c.data),c.remaining=10,c.updateCounter(),c.container.classList.remove(c.finishedClass),c.current=-1,c.next()},c.updateCounter=function(){c.counter.setAttribute("data-remaining",c.remaining),c.counter.setAttribute("title",a.i18n[c.lang].remainingTries.replace("%n",c.remaining))},function(){var b;b=c.container.getElementsByTagName("table"),b[0]&&(a.each(b[0].getElementsByTagName("td"),function(b){var d=a.trim(b.textContent);d.length>0&&c.data.push({original:d,upperCase:a.utf8NormalizeToUpper(d)})}),c.data.length&&(c.pool=a.create({tagName:"div",className:c.poolClass}),b[0].parentNode.replaceChild(c.pool,b[0]),c.pool.appendChild(a.create({tagName:"p",text:a.i18n[c.lang].enterNoticeWordGuessing})),c.pool.appendChild(c.counter),c.counter.classList.add(c.counterClass),c.pool.appendChild(document.createElement("section")),c.pool.lastChild.appendChild(c.input),c.pool.lastChild.appendChild(c.guessedChars),c.pool.lastChild.appendChild(c.guessedCharsIncorrect),c.pool.appendChild(document.createElement("aside")),c.pool.lastChild.appendChild(a.create({tagName:"h2",text:a.i18n[c.lang].foundWords})),c.pool.lastChild.appendChild(c.guessedWords),c.container.addEventListener("click",c.click),c.input.addEventListener("keyup",c.keyUp),c.input.id=c.quizName+"_input",c.finalize(!0),c.container.classList.add(c.finishedClass)))}()},a.quizConstructors.wordjumble=function(b){var c=this;a.quizConstructors._abstractQuiz.call(c,b),c.inputs=[],c.check=function(){var b=!0;a.each(c.data,function(a){a.input.value.length||(b=!1)}),c.hideResultButton(b)},c.end=function(){var d=!0;c.attempts++,a.each(c.data,function(b){b.input.getAttribute("data-solution").toLowerCase()!=a.trim(b.input.value.toLowerCase())&&(d=!1,b.input.classList.add(c.errorClass))}),d?(a.each(c.data,function(a){a.input.value=a.input.getAttribute("data-solution"),a.input.setAttribute("readonly","")}),c.prepareResult(),c.container.classList.add(c.finishedClass),c.uploadData()):c.hideResultButton()},c.start=function(){a.each(c.data,function(b){var c=b.input.getAttribute("data-solution"),d=c.toLowerCase().split("");for(a.shuffleArray(d);b.label.firstChild;)b.label.removeChild(b.label.firstChild);b.label.appendChild(b.input),b.input.value="",b.input.removeAttribute("readonly",""),b.label.appendChild(document.createTextNode(" ("+d.join("")+")"))}),c.container.classList.remove(c.finishedClass),c.hideResultButton(),c.attempts=0},function(){var b=[];a.each(document.querySelectorAll(".rquiz-wordjumble b, .rquiz-wordjumble em, .rquiz-wordjumble i, .rquiz-wordjumble strong"),function(a){for(var d=a;d!=document.body&&d!=c.container;)d=d.parentNode;d==c.container&&b.push(a)}),b.length&&(a.each(b,function(b){var d=a.trim(b.textContent),e=document.createElement("input"),f=document.createElement("label");e.setAttribute("data-solution",d),e.addEventListener("keyup",function(){e.classList.remove(c.errorClass),c.check()}),b.parentNode.replaceChild(f,b),c.data.push({input:e,label:f})}),c.data.length&&(c.container.appendChild(c.pool),c.finalize()))}()},a.quizConstructors.wordsearch=function(b){var c=this;a.quizConstructors._abstractQuiz.call(c,b),c.fixedClass="rquiz-fixed",c.found=document.createElement("ol"),c.highlightEnd=null,c.highlightStart=null,c.dragStart=function(a){var b=c.getEventElement(a);return!b.tagName||!b.tagName.match(/^td$/i)||(c.highlightStart=b,c.dragMode=!0,window.getSelection&&window.getSelection().removeAllRanges(),b.classList.add(c.highlightClass),a.preventDefault(),a.stopPropagation(),!1)},c.dragStop=function(a){return c.resolveDragDrop(),c.removeHighlight(),c.dragMode=!1,c.repairDragAndDropOnIE(),!0},c.dragWhile=function(a){var b=c.getEventElement(a);return c.dragMode&&(c.suppressTextSelection(),b.tagName&&b.tagName.match(/^td$/i)&&(c.highlightEnd=b,c.removeHighlight(),c.highlight()),a.preventDefault(),a.stopPropagation()),!0},c.end=function(){var d,b=!0;c.attempts++,a.each(c.found.getElementsByTagName("li"),function(c){a.trim(c.textContent).length<1&&(b=!1)}),b&&(d="",c.attempts-c.words.length>1?d+=a.i18n[c.lang].praise3:d+=a.i18n[c.lang]["praise"+(1+c.attempts-c.words.length)],d+=" "+a.i18n[c.lang].result3.replace(/%n/,c.attempts),c.prepareResult(d),c.container.classList.add(c.finishedClass),c.removeDragDropListeners(c.container),c.uploadData())},c.highlight=function(){var a,b,d,e,f,g,h;for(h=0;h<c.table.rows.length;h++)for(g=0;g<c.table.rows[h].cells.length;g++)c.table.rows[h].cells[g]==c.highlightStart&&(f={x:g,y:h}),c.table.rows[h].cells[g]==c.highlightEnd&&(b={x:g,y:h});if(!f||!b)return!1;for(d=b.y-f.y==0?2:(b.x-f.x)/(b.y-f.y),e=Math.abs(d)>=.5&&Math.abs(d)<=1.5?d>0?"↘":"↙":Math.abs(d)>1?"→":"↓",g=f.x,h=f.y,a=c.table.rows[h].cells[g];a;){switch(a.classList.add(c.highlightClass),e){case"↓":f.y>b.y&&h>b.y&&h--,f.y<b.y&&h<b.y&&h++;break;case"→":f.x>b.x&&g>b.x&&g--,f.x<b.x&&g<b.x&&g++;break;case"↘":f.x>b.x&&g>b.x&&f.y>b.y&&h>b.y&&(g--,h--),f.x<b.x&&g<b.x&&f.y<b.y&&h<b.y&&(g++,h++);break;case"↙":f.x>b.x&&g>b.x&&f.y<b.y&&h<b.y&&(g--,h++),f.x<b.x&&g<b.x&&f.y>b.y&&h>b.y&&(g++,h--)}a=a!=c.table.rows[h].cells[g]&&c.table.rows[h].cells[g]}},c.resolveDragDrop=function(){var b=c.table.getElementsByClassName(c.highlightClass);b.length<1||(a.each(c.words,function(d){for(var e=0,f=0,g=d.x,h=d.y;e===f&&f<d.upperCase.length;)switch(a.each(b,function(a){c.table.rows[h].cells[g]&&a==c.table.rows[h].cells[g]&&e++}),f++,d.orientation){case"↓":h++;break;case"→":g++;break;case"↘":g++,h++;break;case"↗":g++,h--}e===f&&b.length==f&&(a.each(b,function(a){a.classList.add(c.fixedClass)}),e=!1,a.each(c.found.getElementsByTagName("li"),function(b){a.trim(b.textContent)==d.original&&(e=!0)}),e||a.each(c.found.getElementsByTagName("li"),function(b){a.trim(b.textContent).length<1&&!e&&(b.appendChild(a.create({tagName:"strong",text:d.original})),e=!0)}))}),c.removeHighlight(),c.highlightEnd=null,c.highlightStart=null,c.dragMode=!1,c.end())},c.removeHighlight=function(){a.each(c.table.getElementsByTagName("td"),function(a){a.classList.remove(c.highlightClass)})},c.start=function(){var e,f,g,d=c.createWordGrid(c.data,!0,!0);for(c.attempts=0,c.grid=d.grid,c.words=d.words;c.table.firstChild;)c.table.removeChild(c.table.firstChild);for(f=0;f<c.grid.length;f++)for(g=c.table.insertRow(f),e=0;e<c.grid[0].length;e++)g.appendChild(a.create({tagName:"td",text:c.grid[f][e]?c.grid[f][e]:String.fromCharCode(65+Math.floor(26*Math.random())).toUpperCase()}));for(;c.found.firstChild;)c.found.removeChild(c.found.firstChild);a.each(c.words,function(a){c.found.appendChild(document.createElement("li"))}),c.setDragDropListeners(),c.container.classList.remove(c.finishedClass)},c.suppressTextSelection=function(){window.getSelection&&window.getSelection().removeAllRanges(),c.repairDragAndDropOnIE(!0)},function(){var b,d;if(b=c.container.getElementsByTagName("table"),!b[0])return!1;a.each(b[0].getElementsByTagName("td"),function(b){var d;d=a.trim(b.innerHTML.replace(/&nbsp;/," ")),d.length&&c.data.push({original:d,upperCase:a.utf8NormalizeToUpper(d)})}),c.data.length&&(c.table=b[0],d=b[0].parentNode.insertBefore(document.createElement("aside"),b[0].nextSibling),d.appendChild(a.create({tagName:"h2",text:a.i18n[c.lang].foundWords})),d.appendChild(c.found),b[0].parentNode.insertBefore(c.pool,d.nextSibling),c.finalize())}()},a.init(),window.rQuizInit=function(){a.begin()}}();
